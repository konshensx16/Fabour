{% extends 'base.html.twig' %}
 {% block title %}Editing {{ post.title }}{% endblock %}

{% block body %}

    <div class="section-wrapper mg-t-20">
        {{ form_start(form) }}
            {{ form_errors(form) }}
            {{ form(form) }}
        {{ form_end(form) }}
    </div>
{% endblock %}
{% block javascripts %}
    <script src="{{ asset('build/post.js') }}"></script>
    <script>
        $(function() {
            'use strict';
            // Inline editor

            // TODO: change all the code below to non jquery code
            let $post_category = $("#post_category")
            let $token = $("#post_token")

            $post_category.change(function ()
            {
                let $form = $(this).closest('form')

                let data = {}

                data[$token.attr('name')] = $token.val()
                data[$post_category.attr('name')] = $post_category.val()

                $.post($form.attr('action'), data).then(function (response)
                {
                    $("#post_subCategory").replaceWith(
                        $(response).find("#post_subCategory")
                    )
                })
            })

            function log(msg)
            {
                console.log(msg)
            }
        });
    </script>
{% endblock %}